---
title: "GitHub Actions ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã‚‹æ–¹æ³•"
slug: "how-to-run-github-actions-locally"
tags: [ "Tool", "Docker", "GitHub", "GitHub Actions" ]
thumbnail: "images/logo/github_logo.svg"
description: "GitHub Actions ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚’å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¦ãŠã"
mathjax: false
mermaid: false
iframe: false
date: 2024-05-07T12:00:00+09:00
draft: false
type: "post"
---

GitHub Actions ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã‚’å‚™å¿˜éŒ²ã¨ã—ã¦æ®‹ã—ã¦ãŠã

## å‰æ

* Mac OS
  * OS Version: Sonoma 14.4.1
  * Chip: Apple M1
* Container ç®¡ç†ãƒ„ãƒ¼ãƒ«
  * Rancher Desktop
* ä½¿ç”¨ãƒ„ãƒ¼ãƒ«
  * [act](https://github.com/nektos/act)
* GitHub Actions
  * æ—¢ã«ä½œæˆæ¸ˆæƒ³å®š

## act ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Home Brew ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹

```sh
brew install act
```

## ä½¿ç”¨æ–¹æ³•

1. act ã§å®Ÿè¡Œå¯èƒ½ãªä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹

```sh
act -l
WARN  âš  You are using Apple M-series chip and you have not specified container architecture, you might encounter issues while running act. If so, try running it with '--container-architecture linux/amd64'. âš 
Stage  Job ID  Job name  Workflow name  Workflow file  Events
0      ci      ci        ci             ci.yml         push,pull_request
```

2. act ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦å®Ÿè¡Œã™ã‚‹

ä¾‹. push æ™‚ã® Job ç¢ºèª  
â€»M1 ãªã®ã§ '--container-architecture linux/amd64' ã‚’ä»˜ä¸ã—ã¦å®Ÿè¡Œ

```sh
act push --container-architecture linux/amd64
```

## Trouble Shooting

### docker host ã«é–¢ã™ã‚‹ã‚¨ãƒ©ãƒ¼

```sh
act push --container-architecture linux/amd64
INFO[0000] Using docker host '127.0.0.1', and daemon socket '127.0.0.1'
[ci/ci] ğŸš€  Start image=catthehacker/ubuntu:act-latest
[ci/ci]   ğŸ³  docker pull image=catthehacker/ubuntu:act-latest platform=linux/amd64 username= forcePull=true
Error: failed to connect to docker daemon: unable to parse docker host `127.0.0.1`
```

[å‚è€ƒ](https://github.com/nektos/act/issues/2077) ã‚’å®Ÿæ–½ã™ã‚‹

```sh
export DOCKER_HOST=$(docker context inspect --format '{{.Endpoints.docker.Host}}')
```

### ãƒã‚¦ãƒ³ãƒˆã§ããªã„ã«é–¢ã™ã‚‹ã‚¨ãƒ©ãƒ¼

```sh
act push --container-architecture linux/amd64
INFO[0000] Using docker host 'unix:///Users/<<User Name>>/.rd/docker.sock', and daemon socket 'unix:///Users/<<User Name>>/.rd/docker.sock'
[ci/ci] ğŸš€  Start image=catthehacker/ubuntu:act-latest
[ci/ci]   ğŸ³  docker pull image=catthehacker/ubuntu:act-latest platform=linux/amd64 username= forcePull=true

Error: failed to list containers: error during connect: Get "http://%2FUsers%2F<<User Name>>%2F.rd%2Fdocker.sock/v1.45/containers/json?all=1": EOF
```

[å‚è€ƒ](https://github.com/nektos/act/issues/2239) ã‚’å®Ÿæ–½ã™ã‚‹


```sh:~/.actrc
--container-daemon-socket -
```
