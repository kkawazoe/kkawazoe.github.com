---
title: "Rails における Enum について"
slug: "about_enum_in_rails"
tags: [ "Ruby on Rails" ]
thumbnail: "images/logo/rails_logo.svg"
description: "Rails における Enum の挙動について調査した内容を備忘録として残しておく"
mathjax: false
mermaid: false
date: 2022-12-02T13:00:00+09:00
draft: false
---

Rails における Enum の挙動について調査した内容を備忘録として残しておく

## 環境

* ruby: 2.7.6
* rails: 5.2.8.1

### 実際のコード

DB のカラムに対応する enum を定義した場合、自動的に scope が定義される  
※Rails 6 では `not_*` の scope も自動的に定義される [参考](https://github.com/rails/rails/pull/35381)

[モデル定義]

```rb
class Article < ApplicationRecord
  enum status: {
    draft: 0,      # 下書き
    published: 1,  # 公開中
    closed: 2,     # 掲載終了
  }, _prefix: true
end
```

[Rails Console]

```bash
# enum 確認
Article.statuses
#=> {"draft"=>0, "published"=>1, "closed"=>2}

# scope
Article.status_published
#=> Article Load (7.8ms) SELECT `articles`.* FROM `articles` WHERE `articles`.`status` = 1

# 以下と同義
Article.where(status: :published).to_sql
=> "SELECT `articles`.* FROM `articles` WHERE `articles`.`status` = 1"
```
