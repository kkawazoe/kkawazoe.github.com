<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Bat on My Memorandum For Programming</title>
    <link>http://kkawazoe.github.io/tags/bat/</link>
    <description>Recent content in Bat on My Memorandum For Programming</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>jp</language>
    <lastBuildDate>Sun, 22 Jun 2014 09:01:00 +0900</lastBuildDate>
    
	<atom:link href="http://kkawazoe.github.io/tags/bat/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Windows7環境でバッチファイルからiniファイルを読込んで値を取得する</title>
      <link>http://kkawazoe.github.io/blog/2014/06/22/get-value-from-initialize-file/</link>
      <pubDate>Sun, 22 Jun 2014 09:01:00 +0900</pubDate>
      
      <guid>http://kkawazoe.github.io/blog/2014/06/22/get-value-from-initialize-file/</guid>
      <description>Windows7環境でバッチファイルからiniファイルを読込んで値を取得する方法 対応方法 バッチファイルから ini ファイルを読込む場合VBSを使用することで実現する。
具体的には、バッチファイルから VBS を呼び出して ini ファイルより値を取得して
VBS から戻り値を受け取り、実現する。
取得するiniファイルの中身 [sample.ini]
&amp;lt;設定値&amp;gt;*****************************************************&#39;&amp;lt;コメント&amp;gt;####################################### [Path] WorkPath=c:\src\wk &#39;Work Folder Path  実際のソース [getProfileString.bat]
@echo off set iniFileName=sample.ini for /f &amp;quot;usebackq tokens=* delims=&amp;quot; %%A in (`call cscript //Nologo getProfileString.vbs &amp;quot;%iniFileName%&amp;quot; Path WorkPath`) do set ret=%%A echo &amp;quot;%ret%&amp;quot; pause exit  [getProfileString.vbs]
Option Explicit rem /***************************************************************** rem * getProfileString.vbs iniFileName, sectionName, entryName rem * rem * 引数 rem * iniFileName : 設定ファイル名(フルパス) rem * sectionName : セクション名 rem * entryName : エントリー名 rem * 動作 rem * 引数に指定された設定ファイルより指定した rem * 「セクション」,「エントリー」に対応する設定値を返す。 rem * 先頭がカンマの場合はコメント行として扱う。 rem * 行の途中でカンマがある場合は直前までの文字列(右空白除去)を rem * 設定値として扱う。 rem * 戻り値 rem * 設定値(見つからなかった場合およびエラーの場合は空を返す。) rem *****************************************************************/ Dim ret Dim fs Dim readLineObj Dim searchFlg Dim buffer rem ファイルシステムアクセス用 Set fs = CreateObject( &amp;quot;Scripting.</description>
    </item>
    
    <item>
      <title>Windows7環境でバッチファイルからメッセージボックスを表示して押下されたボタンによって処理を切り替える</title>
      <link>http://kkawazoe.github.io/blog/2014/02/09/switch-processing-by-message-box/</link>
      <pubDate>Sun, 09 Feb 2014 18:46:00 +0900</pubDate>
      
      <guid>http://kkawazoe.github.io/blog/2014/02/09/switch-processing-by-message-box/</guid>
      <description>Windows7環境でバッチファイルからメッセージボックスを表示して押下されたボタンによって処理を切り替える方法 対応方法 バッチファイルからメッセージボックスを表示する場合バッチファイル単体では実現不可のため VBS を使用して実現する。
※具体的には、バッチファイルから VBS を呼び出してメッセージボックスを表示し、 VBS から戻り値を受け取り、処理を切り替える
実際のソース [DispMsgBox.bat]
@echo off rem メッセージボックスの表示 set msg=&amp;quot;メッセージボックスのテスト [\n] で改行します。&amp;quot; set title=&amp;quot;メッセージボックステスト&amp;quot; for /f &amp;quot;usebackq tokens=* delims=&amp;quot; %%A in (`call cscript //Nologo msgbox.vbs %msg% &amp;quot;%title%&amp;quot;`) do set ret=%%A echo %ret% pause exit  [msgbox.vbs]
Option Explicit rem /******************************************************* rem * msgbox.vbs msg [,title] rem * rem * 引数 rem * msg :表示するメッセージ rem * title :メッセージボックスのタイトル rem * 動作 rem * メッセージボックスを表示し、クリックされたボタンに rem * 対応する数値を返す。 rem * msg中の 「\n」という文字列は改行に変換する。 rem * 戻り値 rem * 0:[はい]/1:[いいえ] rem ********************************************************/ Dim args Dim arg(99) Dim value Dim cnt Dim retBtn Dim ret Dim eLevel rem 引数を変数にセット Set args = WScript.</description>
    </item>
    
  </channel>
</rss>